<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Let Children LIVE</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font for an old-ad feel -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400..900;1,400..900&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Playfair Display', serif;
            letter-spacing: 0.05em;
        }
        .protest-quote {
            line-height: 1.5;
            text-align: center;
        }
    </style>
</head>
<body class="bg-zinc-50 text-zinc-800 min-h-screen flex flex-col items-center justify-between p-4">

    <!-- Main content container, centered and responsive -->
    <main class="flex flex-col items-center justify-center w-full text-center">
        <!-- Title section -->
        <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold mb-4 sm:mb-6 tracking-widest leading-snug">
            Let Children…
        </h1>

        <!-- List of activities -->
        <div class="space-y-2 text-base sm:text-lg md:text-xl">
            <p>Play outside.</p>
            <p>Learn.</p>
            <p>Imagine.</p>
            <p>Make a mess in their room.</p>
            <p>Pray.</p>
            <p>Yell at their parents.</p>
            <p>Run.</p>
            <p>Try-out for sports.</p>
            <p>Read a book.</p>
            <p>Get their first A.</p>
            <p>Climb trees.</p>
            <p>Make friends.</p>
            <p>Draw pictures.</p>
            <p>Eat ice cream.</p>
            <p>Ask "why".</p>
            <p>Dance.</p>
            <p>Believe in magic.</p>
        </div>

        <!-- The "LIVE." part in red -->
        <div class="mt-6 sm:mt-8">
            <h2 class="text-red-600 font-extrabold text-7xl sm:text-8xl lg:text-9xl leading-tight tracking-tighter drop-shadow-lg">
                LIVE.
            </h2>
        </div>

        <!-- Statistics and call to action -->
        <div class="mt-8 text-xl sm:text-2xl lg:text-3xl max-w-xl mx-auto space-y-4 font-bold text-center">
            <p>As of August 31, 2025, <span class="text-red-600">Over 50,000</span> children have been killed, and <span class="text-red-600">28/day</span> more are being killed or starved.</p>
            <p>Join the movement to Let Children <span class="text-red-600">LIVE</span>.</p>
        </div>

        <!-- Quote section -->
        <div class="mt-8 mb-4 max-w-xs sm:max-w-sm mx-auto">
            <p class="protest-quote italic text-sm sm:text-base md:text-lg text-zinc-600">
                “To sin by silence<br>
                when they should protest<br>
                makes cowards of men”<br>
                - Abraham Lincoln
            </p>
        </div>

        <!-- Form and Supporters section -->
        <div class="mt-8 w-full max-w-4xl flex flex-col md:flex-row items-start justify-center gap-8 px-4">
            
            <!-- Google Form container -->
            <div class="w-full md:w-1/2 p-6 bg-zinc-100 rounded-lg shadow-inner">
                <h3 class="text-xl sm:text-2xl font-bold mb-4 text-center">Become a Supporter</h3>
                <form id="supporter-form" class="space-y-4">
                    <input 
                        type="text" 
                        id="supporter-name" 
                        placeholder="Enter your name"
                        required
                        class="w-full px-4 py-2 border border-zinc-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500"
                    >
                    <div id="form-message" class="text-center"></div>
                    <button 
                        type="submit" 
                        class="w-full bg-red-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-red-700 transition-colors shadow-md">
                        Join
                    </button>
                </form>
            </div>

            <!-- Supporters list container -->
            <div class="w-full md:w-1/2 p-6 bg-zinc-100 rounded-lg shadow-inner">
                <h3 class="text-xl sm:text-2xl font-bold mb-4 text-center">Supporters</h3>
                <div id="supporters-list" class="space-y-2 text-sm text-zinc-700 overflow-y-auto max-h-64">
                    <p class="text-center">Loading supporters...</p>
                </div>
            </div>
        </div>
    </main>

    <!-- The original footer block that was moved, now empty. -->
    <footer></footer>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // IMPORTANT: Use the provided global variables for app setup
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const authToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        // Set log level to debug for Firestore
        setLogLevel('debug');

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // UI elements
        const form = document.getElementById('supporter-form');
        const nameInput = document.getElementById('supporter-name');
        const supportersList = document.getElementById('supporters-list');
        const formMessage = document.getElementById('form-message');

        // Firestore paths
        const publicCollectionPath = `/artifacts/${appId}/public/data/supporters`;
        let userId = null;

        const handleAuth = async () => {
            try {
                if (authToken) {
                    await signInWithCustomToken(auth, authToken);
                } else {
                    await signInAnonymously(auth);
                }
                userId = auth.currentUser?.uid || crypto.randomUUID();
                // We're authenticated, now we can set up the listeners and forms
                setupListeners();
            } catch (error) {
                console.error("Firebase Auth Error:", error);
                formMessage.textContent = "Error: Could not authenticate. Try again later.";
            }
        };

        const setupListeners = () => {
            // Display supporter ID for debugging/sharing
            const userDisplay = document.createElement('p');
            userDisplay.classList.add('text-xs', 'text-zinc-400', 'mt-2', 'text-center');
            userDisplay.textContent = `Your ID: ${userId}`;
            document.body.appendChild(userDisplay);

            // Set up real-time listener for supporters
            const q = query(collection(db, publicCollectionPath));
            onSnapshot(q, (querySnapshot) => {
                supportersList.innerHTML = '';
                
                // Add the new default supporters
                const staticSupporters = [
                    "Veterans Let Children <span class='text-red-600'>LIVE</span>",
                    "Americans Let Children <span class='text-red-600'>LIVE</span>",
                    "Patriots Let Children <span class='text-red-600'>LIVE</span>",
                    "Mothers Let Children <span class='text-red-600'>LIVE</span>",
                    "Fathers Let Children <span class='text-red-600'>LIVE</span>",
                    "Grandmothers Let Children <span class='text-red-600'>LIVE</span>",
                    "Grandfathers Let Children <span class='text-red-600'>LIVE</span>",
                    "Soldiers Let Children <span class='text-red-600'>LIVE</span>",
                    "Students Let Children <span class='text-red-600'>LIVE</span>"
                ];

                const firestoreSupporters = [];
                querySnapshot.forEach((doc) => {
                    firestoreSupporters.push(doc.data().name);
                });

                const combinedSupporters = [...staticSupporters, ...firestoreSupporters];

                if (combinedSupporters.length > 0) {
                    combinedSupporters.forEach(supporterName => {
                        const supporterP = document.createElement('p');
                        supporterP.classList.add('p-2', 'bg-zinc-50', 'rounded-md', 'shadow-sm');
                        supporterP.innerHTML = supporterName;
                        supportersList.appendChild(supporterP);
                    });
                } else {
                    supportersList.innerHTML = '<p class="text-center text-zinc-400">No supporters yet. Be the first!</p>';
                }
            });

            // Handle form submission
            form.addEventListener('submit', async (e) => {
                e.preventDefault();
                const supporterName = nameInput.value.trim();

                if (supporterName) {
                    try {
                        await addDoc(collection(db, publicCollectionPath), {
                            name: supporterName,
                            timestamp: new Date()
                        });
                        nameInput.value = '';
                        formMessage.textContent = 'Thank you for joining!';
                        formMessage.classList.remove('text-red-500');
                        formMessage.classList.add('text-green-500');
                    } catch (e) {
                        console.error("Error adding document: ", e);
                        formMessage.textContent = "Error joining. Please try again.";
                        formMessage.classList.remove('text-green-500');
                        formMessage.classList.add('text-red-500');
                    }
                }
            });
        };

        // Start the authentication process on page load
        window.onload = handleAuth;
    </script>
</body>
</html>
